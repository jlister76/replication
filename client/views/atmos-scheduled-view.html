<div class="md-padding" id="wrapper">
  <div style="background-color:#0F4A78;width:100%;box-shadow:2px 2px 1px #888888;margin-bottom:1rem;padding: .1rem 0;">
    <p class="md-subhead" style="color:white;">Replications</p>
  </div>
  <table cellpadding="2" cellspacing="0" border="0" width="100%;" style="margin-top:1rem;">
    <thead>
    <th align="left">Date / Time</th>
    <th align="left">Team Leader</th>
    <th align="left">Place</th>
    <th align="left">Address</th>
    <th align="left">Town</th>
    <th align="left">Action</th>
    </thead>
    <tbody>
    <tr ng-repeat="meeting in meetings" class="table_body">
      <td>{{meeting.meeting_datetime | date:'medium' }}</td>
      <td>{{ meeting.team_leader }}</td>
      <td>{{ meeting.location_name }}</td>
      <td>{{ meeting.location }}</td>
      <td>{{ meeting.town }}</td>
      <td>
        <md-button class="md-raised info" ng-click="viewMeeting(meeting)"
                   style="font-size:10px;line-height:18px;min-height:24px!important;height:18px!important; min-width:18px!important;">
          Complete
        </md-button>
      </td>
    </tr>

    </tbody>
  </table>
  <div ng-if="meeting" layout="column" class="view" style="padding:1rem;">
    <div>
      <form name="replicationForm"
            ng-submit="sendEmail(response,meeting)">
        <fieldset class="field_set">
          <legend>Replication Details</legend>
          <div layout="column">
            <div layout="column">
              <div>
                <div layout>
                  <span>Date: </span>
                  <span>{{ meeting.meeting_datetime  | date:'short'}}</span>
                </div>
                <div layout>
                  <span>Team Leader: </span>
                  <span>{{ meeting.team_leader }}</span>
                </div>
                <div layout>
                  <span>Locate Technician: </span>
                  <span>{{ meeting.locate_technician }}</span>
                </div>
                <div layout>
                  <span>Heath Damage Report: </span>
                  <span>{{ meeting.heath_report }}</span>
                </div>
                <div layout>
                  <span>Facility: </span>
                  <span>{{ meeting.facility }}</span>
                </div>
                <div ng-if="meeting.location_name" layout>
                  <span>Meeting Location: </span>
                  <span>{{ meeting.location_name }}</span>
                </div>
                <div layout>
                  <span>Address: </span>
                  <span>{{ meeting.location }}
                <span ng-if="meeting.cross_street">@ {{ meeting.cross_street }}</span>
                </span>
                </div>
                <div layout>
                  <span>Town: </span>
                  <span>{{ meeting.town }}</span>
                </div>
              </div>
            </div>
            <div layout="column" style="padding:.5rem;width:100%;">
              <div style="height:100%; width:100%;">
                <div layout="column" class="md-padding"  style="background-color: #eaeaea;" md-whiteframe="3">
                  <h4>Replication Results</h4>
                  <div layout="column" >
                    <span class="md-caption" style="color: darkorange;"><em><strong>*</strong> required field</em></span>
                    <span style="width:100%;"><strong>Were the locate marks able to be replicated?<span style="color:darkorange;">*</span></strong></span>
                    <select ng-model="response.able_to_replicate" name="able_to_replicate" required
                            ng-change="clearForm(response)"
                            style="margin:1rem;">
                      <option value="Yes">Yes</option>
                      <option value="No">No</option>
                    </select>
                  </div>
                  <div ng-if="response.able_to_replicate === 'Yes'">
                    <div class="row">
                      <div layout="column">
                        <input ng-model="response.atmos_determination"
                               ng-init="response.atmos_determination = 'facility_issue'"
                               type="hidden">
                        <label for="unscheduled_facility_issue"><strong>If there is a facility issue, please describe
                          the root cause.<span style="color:darkorange;">*</span></strong></label>
                        <textarea ng-model="response.atmos_comments" name="facility_issue"
                                  id="unscheduled_facility_issue" cols="30"
                                  rows="7" ng-required="response.atmos_determination === 'facility_issue'"></textarea>
                      </div>
                    </div>
                    <div class="row">
                      <div layout="column">
                        <label for="actions_taken"><strong>Have any corrective actions been taken to resolve the
                          facility issue? Please decsribe.<span style="color:darkorange;">*</span></strong></label>
                        <textarea ng-model="response.corrective_actions" name="actions_taken" id="actions_taken" cols="30"
                                  rows="7" ng-required="response.atmos_determination === 'facility_issue'"></textarea>
                      </div>
                    </div>

                  </div>
                  <div ng-if="response.able_to_replicate === 'No'">
                    <div layout="column" class="row">
                      <strong>Reason<span style="color:darkorange;">*</span></strong>
                      <select ng-model="response.atmos_determination" name="unable_to_replicate"
                              ng-required="response.able_to_replicate === 'No'" style="">
                        <option value="replaced">Facility was altered or replaced</option>
                        <option value="locate_error">Locate Error</option>
                      </select>
                    </div>
                    <div layout="column" class="row">
                      <strong>Is this facility able to be accurately marked?<span style="color:darkorange;">*</span></strong>
                      <select ng-model="response.able_to_locate" name="able_to_locate"
                              ng-required="response.able_to_replicate === 'Yes'" style="">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                      </select>
                    </div>
                    <div ng-if="response.able_to_locate === 'yes'" layout="column" class="row">
                      <strong>Is this line accurately marked as of today?</strong>
                      <select ng-model="response.is_line_marked" name="is_line_marked"
                              ng-required="response.isLocatable === 'yes'" style="">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                      </select>
                    </div>
                    <div layout="column" class="row">
                      <label for="additional_comments"><strong>Did the technician receive any coaching?
                        Please describe.<span style="color:darkorange;">*</span></strong></label>
                      <textarea ng-model="response.atmos_comments" name="additional_comments"
                                id="additional_comments"
                                ng-required="response.able_to_replicate === 'No'"
                                cols="30"
                                rows="7"></textarea>
                    </div>
                  </div>
                </div>
              </div>
              <div>
                <div layout layout-align="end center" style="margin-top:1rem;">
                  <!--html-->
                  <md-button class="md-raised active" type="submit"
                             ng-disabled="replicationForm.$invalid"
                             class="md-raised"
                             ng-class="{'active':replicationForm.$valid}"
                             ng-dblclick="false">SEND RESULTS
                  </md-button>
                </div>
              </div>
            </div>
          </div>
        </fieldset>
      </form>
    </div>
  </div>
</div>
